var b=Object.defineProperty;var l=(n,o)=>b(n,"name",{value:o,configurable:!0});import{r as e}from"./index-4ec46995.js";import{m as v,d as M,e as O,r as B,f as F}from"./Skeleton-d01f91ea.js";function z(){const n=e.useRef(!1);return v(()=>(n.current=!0,()=>{n.current=!1}),[]),n}l(z,"o$1");function S(){const n=z(),[o,s]=e.useState(0),r=e.useCallback(()=>{n.current&&s(o+1)},[o]);return[e.useCallback(()=>M.postRender(r),[r]),o]}l(S,"m");class w extends e.Component{getSnapshotBeforeUpdate(o){const s=this.props.childRef.current;if(s&&o.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=s.offsetHeight||0,r.width=s.offsetWidth||0,r.top=s.offsetTop,r.left=s.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}l(w,"o");function U({children:n,isPresent:o}){const s=e.useId(),r=e.useRef(null),P=e.useRef({width:0,height:0,top:0,left:0});return e.useInsertionEffect(()=>{const{width:p,height:a,top:u,left:E}=P.current;if(o||!r.current||!p||!a)return;r.current.dataset.motionPopId=s;const d=document.createElement("style");return document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${p}px !important;
            height: ${a}px !important;
            top: ${u}px !important;
            left: ${E}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[o]),e.createElement(w,{isPresent:o,childRef:r,sizeRef:P},e.cloneElement(n,{ref:r}))}l(U,"i");const k=l(({children:n,initial:o,isPresent:s,onExitComplete:r,custom:P,presenceAffectsLayout:p,mode:a})=>{const u=O(D),E=e.useId(),d=e.useMemo(()=>({id:E,initial:o,isPresent:s,custom:P,onExitComplete:f=>{u.set(f,!0);for(const i of u.values())if(!i)return;r&&r()},register:f=>(u.set(f,!1),()=>u.delete(f))}),p?void 0:[s]);return e.useMemo(()=>{u.forEach((f,i)=>u.set(i,!1))},[s]),e.useEffect(()=>{!s&&!u.size&&r&&r()},[s]),a==="popLayout"&&(n=e.createElement(U,{isPresent:s},n)),e.createElement(B.Provider,{value:d},n)},"n");function D(){return new Map}l(D,"c");function H(n){return e.useEffect(()=>()=>n(),[])}l(H,"t");const x=l(n=>n.key||"","p"),q=l(({children:n,custom:o,initial:s=!0,onExitComplete:r,exitBeforeEnter:P,presenceAffectsLayout:p=!0,mode:a="sync"})=>{let[u]=S();const E=e.useContext(F).forceRender;E&&(u=E);const d=z(),f=function(t){const c=[];return e.Children.forEach(t,h=>{e.isValidElement(h)&&c.push(h)}),c}(n);let i=f;const m=new Set,y=e.useRef(i),R=e.useRef(new Map).current,g=e.useRef(!0);if(v(()=>{g.current=!1,function(t,c){t.forEach(h=>{const $=x(h);c.set($,h)})}(f,R),y.current=i}),H(()=>{g.current=!0,R.clear(),m.clear()}),g.current)return e.createElement(e.Fragment,null,i.map(t=>e.createElement(k,{key:x(t),isPresent:!0,initial:!!s&&void 0,presenceAffectsLayout:p,mode:a},t)));i=[...i];const C=y.current.map(x),L=f.map(x),A=C.length;for(let t=0;t<A;t++){const c=C[t];L.indexOf(c)===-1&&m.add(c)}return a==="wait"&&m.size&&(i=[]),m.forEach(t=>{if(L.indexOf(t)!==-1)return;const c=R.get(t);if(!c)return;const h=C.indexOf(t);i.splice(h,0,e.createElement(k,{key:x(c),isPresent:!1,onExitComplete:()=>{R.delete(t),m.delete(t);const $=y.current.findIndex(I=>I.key===t);if(y.current.splice($,1),!m.size){if(y.current=f,d.current===!1)return;u(),r&&r()}},custom:o,presenceAffectsLayout:p,mode:a},c))}),i=i.map(t=>{const c=t.key;return m.has(c)?t:e.createElement(k,{key:x(t),isPresent:!0,presenceAffectsLayout:p,mode:a},t)}),e.createElement(e.Fragment,null,m.size?i:i.map(t=>e.cloneElement(t)))},"d");export{q as d};
//# sourceMappingURL=index-ee293eb1.js.map
